
# GAST 投球フォーム解析システム

本システムでは、**単眼カメラで撮影した動画**を入力とし、  
3次元姿勢推定モデル **GAST** を用いて **3次元骨格座標** を推定します。  
さらに、**DTW（動的時間伸縮法）** を用いて複数のフォームを比較・評価することが可能です。  

---

## 必要な環境・パッケージ

### 1. PyTorch のインストール
GPU環境に応じて以下のコマンドでPyTorchをインストールしてください。
```bash
pip3 install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu121
````

### 2. 依存パッケージのインストール

```bash
pip install -r requirements.txt
```

### 3. fastdtw のインストール

```bash
pip install fastdtw
```

---

## プログラム構成

### `output/`

* GASTで推定した **3次元骨格座標ファイル** を保存するディレクトリです。
* 以下のプログラム実行時に利用されます。

---

### `DTW_selected.py`

* `DTW.py` から重要なキーポイント（両肩）を抽出したバージョンです。
* **DTW適用前後の違いを可視化**するためのプロットを出力します。

---

### `DTW_animation.py`

* DTW適用後の結果をアニメーションとして出力します。
* 2つの投球動画を比較し、**フレーム数の短い方**に揃えて再生します。

---

### `sample_score.py`

* 骨格座標間の距離を計算し、**スコアを出力**するプログラムです。
* 投球フォームの定量的な比較に利用します。

---

## 今後の拡張予定

* 部位ごとの重みづけによる評価精度の向上
* 2D推定との比較評価
* 投球フォームのフィードバック機能

```

